<% if notice %>
  <p id="notice" class="flash_sucess"><%= notice %></p>
<%end %>
<% if alert %>
  <p class="flash_fail"><%= alert %></p>
<%end%>


<h6>DASHBOARDS</h6>
<% if @bancos.empty? %>
  <h5>Não há bancos cadastrados, clique em + no canto direito para iniciar. <h5>
<% end %>

<div class="row">
  <div class="col m1"></div>
  <div class="card col m5">
    <span class="card-title">Saldo Bancário</span>
    <div class="grafic chart-panel" style="width: 100%;height:200px;" onclick="chart(this, 'Saldos',<%=  get_data_labels_user(current_user) %>, <%= get_data_values_user(current_user)%>, 'bar');"></div>
    <div class="card-content">
      <p>Data Atual: <%= format_data(data_saldo_atual()) %> </p>
      <p>Saldo Atual: <%=number_to_currency( saldo_atual()) %> </p>
    </div>
  </div>
  <div class="col m1"></div>
  <div class="card col m5">
    <span class="card-title">Dividendos</span>
    <div class="grafic chart-panel" style="width: 100%;height:200px;" onclick="chart(this, 'Dividendos',<%=  get_data_labels_dividendos(current_user) %>, <%= get_data_values_dividendos(current_user)%>, 'bar');"></div>
    <div class="card-content">
      <p>Mês atual: <%= Date.today.strftime("%m/%Y") %> </p>
      <p>Gasto do mês atual: <%=number_to_currency( gasto_atual()) %> </p>
    </div>
  </div>
</div>

<h6>BANCOS</h6>

<div class="row">
<% @bancos.each do |banco| %>
    <div class="col s12 m4">
      <div class="card">
        <div class="card-image">
          <div class="grafic chart-panel" style="width: 100%;height:200px;" onclick="chart(this, 'Saldos',<%=  get_data_labels_banco(banco) %>, <%= get_data_values_banco(banco)%>, 'line');"></div>
          <%= link_to new_saldo_path(banco), class:"btn-floating halfway-fab waves-effect waves-light red" do %>
            <i class="material-icons">add</i>
          <% end %>
        </div>
        <div class="card-content">
          <span class="card-title"><%= link_to banco.nome, banco_path(banco.id) %></span>
          <small><%= banco.tipo %></small>
          <p>Saldo Atual: <%=number_to_currency( ultimo_valor(banco)) %> </p>
        </div>
      </div>
    </div>
<% end %>
</div>

<div class="fixed-action-btn">
  <%= link_to  new_banco_path, class:"btn-floating btn-large waves-effect waves-light red" do%>
    <i class="material-icons">add</i>
  <% end %>
</div>

<script>
  document.querySelectorAll(".grafic").forEach(grafic => {
    grafic.click();
  });
</script>